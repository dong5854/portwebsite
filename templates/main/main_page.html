<!DOCTYPE html>
<html lang="en">

<head>
  {% load static %}
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="{% static 'images/favicon.ico' %}">
  <title>메인페이지</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous">
  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
  <link rel="stylesheet" type="text/css"
    href="{% static 'assets/vendor_components/bootstrap/dist/css/bootstrap.css' %}">
  <!-- 폰트시작 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap" rel="stylesheet">
  <!-- 폰트 끝 -->
  {% comment %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> {% endcomment %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.0/dist/chart.min.js"></script>
  <!--네이버 openapi-->
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=clkjj6mzd0"></script>
  <!--CRMi Style-->
  <link rel="stylesheet" href="{% static 'src/css/style.css' %}">
  <link rel="stylesheet" href="{% static 'src/css/skin_color.css' %}">
  <!-- Vendors Style-->
  <link rel="stylesheet" href="{% static 'src/css/vendors_css.css' %}">
  <!--Custom JS-->
  <script src="{% static 'ShowingHarbor.js' %}"></script>
  {% load sass_tags %}
  <link rel="stylesheet" href="{% sass_src 'weather_test.scss' %}">
</head>
<style>
  * {
    font-family: 'Noto Sans KR', sans-serif;
  }

  #map {
    width: 100%;
    height: 500px;
    float:right;
  }
</style>
<script>
  let a = 0
  let map //네이버 지도 오브젝트(전역으로 해야됨)
  $(document).ready(function () {
    ShowingStatus()
    ShowingAnchorage()
    $.ajax({
      type: 'GET',
      url: "{% url 'GetHarborData' %}",
      dataType: "json",
      data: {
      },
      error: function () {
        alert("오류!")
      },
      success: function (data) {
        data_json = data
        console.log(data_json['date'])
      }
    })
    map = new naver.maps.Map('map', {
      center: new naver.maps.LatLng(35.44043374181368, 129.3934977814075),
      zoom: 10,
      zoomControl: true,
      zoomControlOptions: {
        style: naver.maps.ZoomControlStyle.SMALL,
        position: naver.maps.Position.TOP_RIGHT
      }
      
    });
  })

  function ShowingStatus() {
    var port_name = "{{항구이름|escapejs}}"
    var port_status = "{{상태|escapejs}}"
    var name_lst = stringToList(port_name)
    var status_lst = stringToList(port_status)
    /*for(let i=0;i<name_lst.length;i++){ 
      let temp_html = `<li>${name_lst[i]}:${status_lst[i]}</li>`
      $('#marker').append(temp_html)
    }*/
    let temp_count_normal = status_lst.filter(element => '정상' === element).length
    let temp_count_abnormal = status_lst.filter(element => '일부파손' === element).length
    data = {
      datasets: [{
        backgroundColor: ['rgba(65,105,225,1)', 'rgba(220,20,60,1)'],
        data: [temp_count_normal, temp_count_abnormal],
        hoverBorderColor: "rgba(234, 236, 244, 1)",
      }],
      labels: ['정상', '일부파손']
    };
    var ctx1 = document.getElementById("myChart1");
    var myPieChart = new Chart(ctx1, {
      type: 'pie',
      data: data,
      options: {
        animation: {
					duration: 3000
				},
				responsive: true,
				legend: {
					labels: {
						fontFamily: "Nunito Sans",
						fontColor: "#878787"
					}
				},
				tooltip: {
					backgroundColor: 'rgba(33,33,33,1)',
					cornerRadius: 0,
					footerFontFamily: "'Nunito Sans'"
				},
				elements: {
					arc: {
						borderWidth: 0
					}
				}
      }
    });
  }

  function ShowingAnchorage() {
    var ctx = document.getElementById('anchoragechart').getContext('2d');
    var chart = new Chart(ctx, { // The type of chart we want to create 
      type: 'bar', // The data for our dataset 
      data: {
        labels: ['E1', 'E2', 'E3', 'etc'],
        datasets: [{
          backgroundColor: [
            'rgba(54, 162, 235, 0.5)',
            'rgba(255, 206, 86, 0.5)',
            'rgba(75, 192, 192, 0.5)',
            'rgba(153, 102, 255, 0.5)',
          ],
          borderColor: [
            'rgba(54, 162, 235, 1.5)',
            'rgba(255, 206, 86, 1.5)',
            'rgba(75, 192, 192, 1.5)',
            'rgba(153, 102, 255, 1.5)',
          ],
          data: [{{ E1_quantity| safe}},{{ E2_quantity| safe}}, {{ E3_quantity | safe }}, {{ etc_quantity | safe }}]
          }
        ]
      },
  options: {
    plugins: {
      legend: {
        display: false
      },
      tooltips: {
        enabled: false
      }
    }
  }
  }
  );
}

  function stringToList(inputstring) {
    inputstring = inputstring.replace('[', '');
    inputstring = inputstring.replace(']', '');
    inputstring = inputstring.replace(/(\s*)/g, "");
    inputstring = inputstring.replace(/'/gi, '');
    return inputstring.split(",");
  }
</script>

<body class="hold-transition sidebar-mini theme-primary fixed">
  <div class="wrapper">
    <div id="loader"></div>
    <!-- 네비게이션바 시작 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="{% url 'main' %}">힘찬불나방</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'anchorage' %}">정박지 현황</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'ship_position' %}">실시간 선박 위치추적</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'wharf' %}">부두 현황</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'safety' %}">안전 재난경보</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- 네비게이션바 끝 -->
    <div class="content-wrapper" style="margin-left:1rem;">
      <div class="container-full">
        <!--대시보드 제목 넣을거면 여기다 넣으면됨
      <div class="content-header">
					<div class="d-flex align-items-center">
						<div class="me-auto">
							<h4 class="page-title">통합관제 대시보드</h4>
						</div>
					</div>
        </div>-->
        <section class="content">
          <div class="row">

            <div class="col-xl-6 col-xxxl-6">
              <div class="box">
                <div class="box-header">
                  <h3 class="box-title">실시간 부두상태</h3>
                </div>
                <div class="box-body">

                  <div style="float:left">
                    <canvas id="myChart1" style="height:300px;width:300px;display:block;"></canvas>
                  </div>

                  <h1>일부 파손</h1>
                  <li>OTK2부두2선석</li>


                </div>
              </div>
              <div class="box">
                  <div class="box-header">
                      <h3 class="box-title">부두 작업현황</h3>
                  </div>
                  <div class="box-body" style="padding:0%">
                    <div class="row" style="margin:0%">
                      <div class="col-xl-4 list-group" id="list-tab" role="tablist" style="padding:0rem">
                        <h3 style="text-align: center;">부두목록</h3>
                        <div class="inner-content-div">
                          <a class="list-group-item list-group-item-action" id="list-home-list"
                              data-bs-toggle="list" href="#list-home" role="tab" aria-controls="list-home">제1부두</a>
                          <a class="list-group-item list-group-item-action" id="list-profile-list" data-bs-toggle="list"
                              href="#list-profile" role="tab" aria-controls="list-profile">제2부두</a>
                          <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제3부두</a>
                          <a class="list-group-item list-group-item-action" id="list-settings-list"
                              data-bs-toggle="list" href="#list-settings" role="tab"
                              aria-controls="list-settings" onclick="test()">제4부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제5부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제6부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제7부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제8부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제9부두</a>
                              <a class="list-group-item list-group-item-action" id="list-messages-list"
                              data-bs-toggle="list" href="#list-messages" role="tab"
                              aria-controls="list-messages">제10부두</a>

                        </div>
                        <h3 style="text-align: center; background-color:lightcyan;">제2부두 작업현황</h3>
                        <table class="table">
                          <thead>
                            <tr>
                              <th scope="col">#</th>
                              <th scope="col">선석</th>
                              <th scope="col">사용유무</th>
                              <th scope="col">최근 관제</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <th scope="row">1</th>
                              <td>01</td>
                              <td>사용중</td>
                              <td>SUBARU 7(접안)</td>
                            </tr>
                            <tr>
                              <th scope="row">2</th>
                              <td>02</td>
                              <td>사용중</td>
                              <td>CLIPPER ORION(접안)</td>
                            </tr>
                            <tr>
                              <th scope="row">3</th>
                              <td colspan="1">03</td>
                              <td>비었음</td>
                              <td>GINGA CARACAL(출항)</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="col-xl-8" style="padding:0px">
                          <div id="map"></div>
                      </div>
                      </div>
                  </div>
              </div>
              </div>
              <div class="col-xl-6" style="padding:0">
                  <div class="box bg-img box-inverse"
                      style="background-image: url(../../../images/gallery/thumb/4.jpg);" data-overlay="5">
                      <div class="box-header">
                          <h3 class="box-title">오늘의 날씨</h3>
              </div>
              <div class="box-body">
                  <div class="row">
                <div class="p-5 col-xl-4">
                  <h3 class="white">
                    <span class="fs-30">울산, </span>대한민국
                  </h3>
                  <p class="weather-day-date mb-30">
                    <span class="me-5">{{관측시간}}</span>
                  </p>
                  <div class="mb-30 weather-icon">
                      {% if 날씨 == "맑음" %}
                      <img src="{% static 'main/sun.svg' %}" alt="이미지 준비중입니다.">
                      {% elif 날씨 == "구름 많음" %}
                      <img src="{% static 'main/clouds.svg' %}" alt="이미지 준비중입니다.">
                      {% elif 날씨 == "흐림" %}
                      <div class="svg-contain">
                        <svg class="overcast-clouds" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 82.6 52.3" style="enable-background:new 0 0 82.6 52.3;" xml:space="preserve">
                    <g id="Layer_1">
                        <path class="cloud-still" d="M21.8,24.2c0.1,0,0.3-1.1,0.4-1.2c0.5-1.2,1.1-2.4,1.8-3.4c3.9-5.7,12.6-7.1,18.2-3.1c0,0,3.7-6,11-5.9
                            c0,0,5.6-0.6,10.3,4.9c0,0,2.8,3.3,2.9,7.4c0,0,3.2-0.5,5.4,1c0,0,6.2,2.6,5.9,10.8H56.3c0,0-2-3.5-7.3-3.6c0.2,0-0.5-2.2-0.6-2.4
                            c-1.4-4.4-5.5-6.9-9.9-7.4c-3.4-0.4-6.6,0.8-9,3.2c-0.1,0.1-1.2,1.3-1.2,1.3S25.3,23.6,21.8,24.2z"/>
                        <path class="cloud-still" d="M57.6,40.7c0-4.8-3.9-8.6-8.6-8.6c-0.2,0-0.4,0-0.6,0.1c-0.1-0.8-0.2-1.7-0.4-2.4c-0.3-1-0.8-2-1.4-2.9
                            c-2-2.9-5.3-4.8-9-4.8c-2.3,0-4.4,0.7-6.1,1.9c-0.6,0.4-1.1,0.8-1.6,1.3c-0.2,0.2-0.5,0.5-0.7,0.8c-0.2,0.3-0.4,0.5-0.6,0.8
                            c-1.8-1.2-3.9-1.9-6.2-1.9c-5.5,0-10,4-10.8,9.3c-3.5,1-6.1,3.9-6.6,7.6h26.3h12.7h12.9h0.7C57.6,41.8,57.6,41.4,57.6,40.7z"/>
                    </g>
                    <g id="Layer_2">
                    </g>
                    </svg></div>
                      {% elif 날씨 == "비" %}
                      <img src="{% static 'main/rain.svg' %}" alt="이미지 준비중입니다.">
                      {% elif 날씨 == "눈" %}
                      <img src="{% static 'main/snow.svg' %}" alt="이미지 준비중입니다.">
                      {% elif 날씨 == "소나기" %}
                      <img src="{% static 'main/rain.svg' %}" alt="이미지 준비중입니다.">
                      {% else %}
                      이미지 준비중입니다ㅠㅠ
                      {% endif %}
                    <div class="d-inline-block">
                      <span class="fs-50">{{기온}}°
                        <span class="fs-40">C</span>
                      </span>
                      <p class="text-start">{{날씨}}</p>
                    </div>
                  </div>
                </div>
                <div class="col-xl-8">
                    <h3>
                      관측시간: {{관측시간}} <br>
                      관측소 명: {{관측소명}}<br>
                      조위: {{조위}}cm <br>
                      수온: {{수온}}℃ <br>
                      염분: {{염분}}psu <br>
                      기온: {{기온}}℃ <br>
                      기압: {{기압}}hPa <br>
                      풍향: {{풍향}}deg <br>
                      풍속: {{풍속}}m/s <br>
                      돌풍: {{돌풍}}m/s<br>
                    </h3>
                  </div>
                </div>
                  <div class="row no-space">
                    <div class="col-2">
                      <div>
                        <div class="mb-10">TUE</div>
                        <i class="wi-day-sunny fs-30 mb-10"></i>
                        <div>24°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                    <div class="col-2">
                      <div>
                        <div class="mb-10">WED</div>
                        <i class="wi-day-cloudy fs-30 mb-10"></i>
                        <div>21°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                    <div class="col-2">
                      <div>
                        <div class="mb-10">THU</div>
                        <i class="wi-day-sunny fs-30 mb-10"></i>
                        <div>25°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                    <div class="col-2">
                      <div>
                        <div class="mb-10">FRI</div>
                        <i class="wi-day-cloudy-gusts fs-30 mb-10"></i>
                        <div>20°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                    <div class="col-2">
                      <div>
                        <div class="mb-10">SAT</div>
                        <i class="wi-day-lightning fs-30 mb-10"></i>
                        <div>18°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                    <div class="col-2">
                      <div>
                        <div class="mb-10">SUN</div>
                        <i class="wi-day-storm-showers fs-30 mb-10"></i>
                        <div>14°
                          <span class="fs-12">C</span>
                        </div>
                      </div>
                    </div>
                  </div>
              </div>
              <!-- /.box-body -->
            </div>
              <div class="box">
                <div class="box-header">
                  <h3 class="box-title">정박지 현황</h3>
                </div>
                <div class="card-body">

                  <div style="float:center; width:70%;margin:0 auto">
                    <canvas id="anchoragechart"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>                           
        </section>
      </div>
    </div>
  </div>
  <!-- Vendor JS -->
  <!-- <script src="../src/js/vendors.min.js"></script> -->
  <script src="{% static 'src/js/vendors.min.js' %}"></script>
  <!-- <script src="../src/js/pages/chat-popup.js"></script> -->
  <script src="{% static 'src/js/pages/chat-popup.js' %}"></script>
  <!-- <script src="../../../assets/icons/feather-icons/feather.min.js"></script> -->
  <script src="{% static 'assets/icons/feather-icons/feather.min.js' %}"></script>

  <!-- <script src="../../../assets/vendor_components/Flot/jquery.flot.js"></script> -->
  <script src="{% static 'assets/vendor_components/Flot/jquery.flot.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/Flot/jquery.flot.resize.js"></script> -->
  <script src="{% static 'assets/vendor_components/Flot/jquery.flot.resize.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/Flot/jquery.flot.pie.js"></script> -->
  <script src="{% static 'assets/vendor_components/Flot/jquery.flot.pie.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/Flot/jquery.flot.categories.js"></script> -->
  <script src="{% static 'assets/vendor_components/Flot/jquery.flot.categories.js' %}"></script>
  <!-- <script src="../src/js/pages/sampledata1.js"></script> -->
  <script src="{% static 'src/js/pages/sampledata1.js' %}"></script>
  <!-- <script src="../src/js/pages/sampledata2.js"></script> -->
  <script src="{% static 'src/js/pages/sampledata2.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/apexcharts-bundle/irregular-data-series.js"></script> -->
  <script src="{% static 'assets/vendor_components/apexcharts-bundle/irregular-data-series.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/apexcharts-bundle/dist/apexcharts.js"></script> -->
  <script src="{% static 'assets/vendor_components/apexcharts-bundle/dist/apexcharts.js' %}"></script>
  <!-- <script src="../../../assets/vendor_components/jquery.peity/jquery.peity.js"></script> -->
  <script src="{% static 'assets/vendor_components/jquery.peity/jquery.peity.js' %}"></script>
  <script src="{% static 'assets/vendor_plugins/weather-icons/WeatherIcon.js' %}"></script>
  <!-- CRMi App -->
  <!-- <script src="../src/js/template.js"></script> -->
  <script src="{% static 'src/js/template.js' %}"></script>
  <!-- <script src="../src/js/pages/reports.js"></script> -->
  <script src="{% static 'src/js/pages/reports.js' %}"></script>
  <script src="{% static 'src/js/pages/weather.js' %}"></script>
  <script src="{% static 'src/js/pages/widget-charts2.js' %}"></script>
  <script src="{% static 'src/js/pages/widget-inline-charts.js' %}"></script>
</body>

</html>